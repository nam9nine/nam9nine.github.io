{% endfor %}
<!-- (2) 자바스크립트: 부모/자식 독립 + 폴더 아이콘 shown.bs.collapse/hidden.bs.collapse 
     (즉, 펼침/접힘 완료 후 바뀜), 
     속도만 CSS로 빠르게 조정 -->
<script>
document.addEventListener('DOMContentLoaded', function() {
  // (A) 자식 Collapse 이벤트 전파 차단 (독립 동작)
  document.addEventListener('show.bs.collapse', function(e) {
    if (e.target.classList.contains('child-collapse')) {
      e.stopPropagation(); 
      e.stopImmediatePropagation();
    }
  }, true);
  document.addEventListener('hide.bs.collapse', function(e) {
    if (e.target.classList.contains('child-collapse')) {
      e.stopPropagation(); 
      e.stopImmediatePropagation();
    }
  }, true);
  // (B) shown.bs.collapse → 폴더 아이콘 열림
  document.addEventListener('shown.bs.collapse', function(e) {
    let trig = document.querySelector('[href="#' + e.target.id + '"]');
    if (!trig) return;
    // 루트 열림
    if (trig.classList.contains('root-trigger')) {
      let cardHeader = trig.closest('.card-header');
      if (cardHeader) {
        let rootIcon = cardHeader.querySelector('.root-folder-icon');
        if (rootIcon) {
          rootIcon.classList.remove('fa-folder');
          rootIcon.classList.add('fa-folder-open');
        }
      }
    }
    // 하위 열림
    else if (trig.classList.contains('sub-trigger')) {
      let listItem = trig.closest('.list-group-item');
      if (listItem) {
        let subIcon = listItem.querySelector('.sub-folder-icon');
        if (subIcon) {
          subIcon.classList.remove('fa-folder');
          subIcon.classList.add('fa-folder-open');
        }
      }
    }
  });
  // (C) hidden.bs.collapse → 폴더 아이콘 닫힘
  document.addEventListener('hidden.bs.collapse', function(e) {
    let trig = document.querySelector('[href="#' + e.target.id + '"]');
    if (!trig) return;
    // 루트 닫힘
    if (trig.classList.contains('root-trigger')) {
      let cardHeader = trig.closest('.card-header');
      if (cardHeader) {
        let rootIcon = cardHeader.querySelector('.root-folder-icon');
        if (rootIcon) {
          rootIcon.classList.remove('fa-folder-open');
          rootIcon.classList.add('fa-folder');
        }
      }
    }
    // 하위 닫힘
    else if (trig.classList.contains('sub-trigger')) {
      let listItem = trig.closest('.list-group-item');
      if (listItem) {
        let subIcon = listItem.querySelector('.sub-folder-icon');
        if (subIcon) {
          subIcon.classList.remove('fa-folder-open');
          subIcon.classList.add('fa-folder');
        }
      }
    }
  });
});
</script>